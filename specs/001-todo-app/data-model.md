# Data Model: Todo App MVP

**Feature**: 001-todo-app | **Date**: 2026-02-06

## Entities

### User (managed by Better Auth)

Better Auth creates and manages this table. The backend does NOT modify it directly.

| Field | Type | Constraints | Notes |
|-------|------|-------------|-------|
| id | string (UUID) | PK | Generated by Better Auth |
| email | string | UNIQUE, NOT NULL | Login identifier |
| name | string | NOT NULL | Display name |
| emailVerified | boolean | | Better Auth default field |
| image | string | NULLABLE | Better Auth default field |
| createdAt | timestamp | NOT NULL | Auto-set |
| updatedAt | timestamp | NOT NULL | Auto-set |

**Note**: Better Auth also creates `session`, `account`, and `verification` tables. These are managed entirely by Better Auth and are not accessed by the backend.

### Task (managed by backend)

| Field | Type | Constraints | Notes |
|-------|------|-------------|-------|
| id | string (UUID) | PK, default: uuid4() | Server-generated, non-sequential |
| title | string | NOT NULL, max 255 chars | Required field |
| description | string | NULLABLE, max 2000 chars | Optional field |
| status | string | NOT NULL, default: "pending" | One of: "pending", "in_progress", "completed" |
| priority | string | NOT NULL, default: "medium" | One of: "low", "medium", "high" |
| user_id | string (UUID) | NOT NULL, INDEX | References Better Auth user.id |
| created_at | timestamp | NOT NULL, default: now() | Auto-set on creation |
| updated_at | timestamp | NOT NULL, default: now() | Auto-set on creation, updated on modification |

**Indexes**:
- `ix_task_user_id` on `user_id` — every query filters by user_id
- `ix_task_created_at` on `created_at` — default sort order is newest first

## Relationships

```
User (1) ──── (*) Task
  │                │
  └── user.id ◄── task.user_id
```

- One user has many tasks.
- A task belongs to exactly one user.
- Deleting a user should cascade-delete their tasks (handled at DB level if needed; out of scope for MVP since no user deletion feature exists).

## State Transitions

### Task Status

```
pending ──→ in_progress ──→ completed
   │                            │
   └────────────────────────────┘
              (any direction)
```

All status transitions are allowed. There are no restricted transitions in the MVP. Users can freely move tasks between any status.

## Schema Separation (SQLModel)

| Model | Purpose | `table=True` |
|-------|---------|-------------|
| Task | Database table definition | Yes |
| TaskCreate | POST request body (title, description, status, priority) | No |
| TaskRead | GET response body (all fields including id, user_id, timestamps) | No |
| TaskUpdate | PATCH request body (all fields optional) | No |

## Validation Rules

| Field | Rule | Source |
|-------|------|--------|
| title | Non-empty, max 255 characters | FR-010 |
| description | Max 2000 characters (nullable) | FR-010 |
| status | Must be one of: "pending", "in_progress", "completed" | FR-012 |
| priority | Must be one of: "low", "medium", "high" | FR-013 |
| user_id | Extracted from JWT, never from request body | FR-009 |
